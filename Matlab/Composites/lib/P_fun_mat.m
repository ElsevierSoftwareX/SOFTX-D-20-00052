% Function: P matrices for composite materials
function P_fun_val = P_fun_mat(xs, ys, xa, ya, xd, yd, a, b)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%   Input paramters:
%       xs, ys          -   X and Y coordinates of the sensor location
%       xa, ya          -   X and Y coordinates of the actuator location
%       xd, yd          -   X and Y coordinates of the damage location
%       a, b            -   Horizontal and vertical axes of the ellipse
%                           representing the spatial distribution of wave 
%                           propagation velocity
%
%   Output parameters:
%       P_fun_val      -   Multiplication of gradient of the time-of-flight
%                          model in a matrix form
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
P_fun_val = [((-1/2).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^(1/2).*(2.*a.^4.*b.^(-2) ...
  .*((-1).*xa+xd).^(-3).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd) ...
  .^(-2).*((-1).*ya+yd).^2).^(-2)+2.*a.^4.*b.^(-2).*((-1).*xa+xd).^(-5).*( ...
  (-1).*ya+yd).^4.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd) ...
  .^2).^(-2)+(-2).*a.^2.*((-1).*xa+xd).^(-3).*((-1).*ya+yd).^2.*(1+a.^2.* ...
  b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).*(a.^2.*(1+a.^2.* ...
  b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+ ...
  xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*(( ...
  -1).*ya+yd).^2).^(-1)).^(-3/2)+(-1).*(xa+(-1).*xd).*((xa+(-1).*xd).^2+( ...
  ya+(-1).*yd).^2).^(-1/2).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).* ...
  ((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+ ...
  a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-1/2)+( ...
  -1/2).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^(1/2).*((-2).*a.^4.*b.^(-2) ...
  .*((-1).*xd+xs).^(-3).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs) ...
  .^(-2).*((-1).*yd+ys).^2).^(-2)+(-2).*a.^4.*b.^(-2).*((-1).*xd+xs).^(-5) ...
  .*((-1).*yd+ys).^4.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-2)+2.*a.^2.*((-1).*xd+xs).^(-3).*((-1).*yd+ys).^2.*(1+a.^2.*b.^( ...
  -2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^( ...
  -2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^( ...
  -2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ ...
  ys).^2).^(-1)).^(-3/2)+(-1).*((-1).*xd+xs).*(((-1).*xd+xs).^2+((-1).*yd+ ...
  ys).^2).^(-1/2).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).* ...
  yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.* ...
  b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-1/2)).^2,(( ...
  -1/2).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^(1/2).*(2.*a.^4.*b.^(-2).*(( ...
  -1).*xa+xd).^(-3).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^( ...
  -2).*((-1).*ya+yd).^2).^(-2)+2.*a.^4.*b.^(-2).*((-1).*xa+xd).^(-5).*(( ...
  -1).*ya+yd).^4.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2) ...
  .^(-2)+(-2).*a.^2.*((-1).*xa+xd).^(-3).*((-1).*ya+yd).^2.*(1+a.^2.*b.^( ...
  -2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^( ...
  -2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^( ...
  -2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+ ...
  yd).^2).^(-1)).^(-3/2)+(-1).*(xa+(-1).*xd).*((xa+(-1).*xd).^2+(ya+(-1).* ...
  yd).^2).^(-1/2).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).* ...
  ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.* ...
  b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-1/2)+(-1/2).*( ...
  ((-1).*xd+xs).^2+((-1).*yd+ys).^2).^(1/2).*((-2).*a.^4.*b.^(-2).*((-1).* ...
  xd+xs).^(-3).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*( ...
  (-1).*yd+ys).^2).^(-2)+(-2).*a.^4.*b.^(-2).*((-1).*xd+xs).^(-5).*((-1).* ...
  yd+ys).^4.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^( ...
  -2)+2.*a.^2.*((-1).*xd+xs).^(-3).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*(( ...
  -1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*(( ...
  -1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*(( ...
  -1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2) ...
  .^(-1)).^(-3/2)+(-1).*((-1).*xd+xs).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2) ...
  .^(-1/2).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-1/2)).*((-1/2).*((xa+ ...
  (-1).*xd).^2+(ya+(-1).*yd).^2).^(1/2).*((-2).*a.^4.*b.^(-2).*((-1).*xa+ ...
  xd).^(-2).*((-1).*ya+yd).*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).* ...
  ya+yd).^2).^(-2)+(-2).*a.^4.*b.^(-2).*((-1).*xa+xd).^(-4).*((-1).*ya+yd) ...
  .^3.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+2.* ...
  a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).*(1+a.^2.*b.^(-2).*((-1).*xa+ ...
  xd).^(-2).*((-1).*ya+yd).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+ ...
  xd).^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+ ...
  yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)) ...
  .^(-3/2)+(-1).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^(-1/2).*(ya+(-1).* ...
  yd).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^( ...
  -1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1) ...
  .*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-1/2)+(-1/2).*(((-1).*xd+xs) ...
  .^2+((-1).*yd+ys).^2).^(1/2).*(2.*a.^4.*b.^(-2).*((-1).*xd+xs).^(-2).*(( ...
  -1).*yd+ys).*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^( ...
  -2)+2.*a.^4.*b.^(-2).*((-1).*xd+xs).^(-4).*((-1).*yd+ys).^3.*(1+a.^2.* ...
  b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+(-2).*a.^2.*((-1) ...
  .*xd+xs).^(-2).*((-1).*yd+ys).*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*(( ...
  -1).*yd+ys).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*(( ...
  -1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+ ...
  a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-3/2)+( ...
  -1).*((-1).*yd+ys).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^(-1/2).*(a.^2.* ...
  (1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*(( ...
  -1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^( ...
  -2).*((-1).*yd+ys).^2).^(-1)).^(-1/2)),((-1/2).*((xa+(-1).*xd).^2+(ya+( ...
  -1).*yd).^2).^(1/2).*((-2).*a.^3.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).* ...
  ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^( ...
  -2)+(-2).*a.^3.*b.^(-2).*((-1).*xa+xd).^(-4).*((-1).*ya+yd).^4.*(1+ ...
  a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+2.*a.*(1+ ...
  a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+2.*a.*((-1) ...
  .*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2) ...
  .*((-1).*ya+yd).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2) ...
  .*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*( ...
  1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-3/2)+( ...
  -1/2).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^(1/2).*((-2).*a.^3.*b.^(-2) ...
  .*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs) ...
  .^(-2).*((-1).*yd+ys).^2).^(-2)+(-2).*a.^3.*b.^(-2).*((-1).*xd+xs).^(-4) ...
  .*((-1).*yd+ys).^4.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-2)+2.*a.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-1)+2.*a.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2) ...
  .*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-1)).^(-3/2)).*((-1/2).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^( ...
  1/2).*(2.*a.^4.*b.^(-2).*((-1).*xa+xd).^(-3).*((-1).*ya+yd).^2.*(1+ ...
  a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+2.*a.^4.* ...
  b.^(-2).*((-1).*xa+xd).^(-5).*((-1).*ya+yd).^4.*(1+a.^2.*b.^(-2).*((-1) ...
  .*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+(-2).*a.^2.*((-1).*xa+xd).^(-3) ...
  .*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd) ...
  .^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd) ...
  .^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-3/2)+(-1).*(xa+(-1).* ...
  xd).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^(-1/2).*(a.^2.*(1+a.^2.*b.^( ...
  -2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^( ...
  -2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+ ...
  yd).^2).^(-1)).^(-1/2)+(-1/2).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^( ...
  1/2).*((-2).*a.^4.*b.^(-2).*((-1).*xd+xs).^(-3).*((-1).*yd+ys).^2.*(1+ ...
  a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+(-2).*a.^4.* ...
  b.^(-2).*((-1).*xd+xs).^(-5).*((-1).*yd+ys).^4.*(1+a.^2.*b.^(-2).*((-1) ...
  .*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+2.*a.^2.*((-1).*xd+xs).^(-3).*(( ...
  -1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2) ...
  .^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2) ...
  .^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*(( ...
  -1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-3/2)+(-1).*((-1).*xd+xs) ...
  .*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^(-1/2).*(a.^2.*(1+a.^2.*b.^(-2).* ...
  ((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).* ...
  ((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-1)).^(-1/2)),((-1/2).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^(1/2) ...
  .*(2.*a.^4.*b.^(-3).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.* ...
  b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+2.*a.^4.*b.^(-3).* ...
  ((-1).*xa+xd).^(-4).*((-1).*ya+yd).^4.*(1+a.^2.*b.^(-2).*((-1).*xa+xd) ...
  .^(-2).*((-1).*ya+yd).^2).^(-2)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd) ...
  .^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd) ...
  .^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^( ...
  -3/2)+(-1/2).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^(1/2).*(2.*a.^4.*b.^( ...
  -3).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+ ...
  xs).^(-2).*((-1).*yd+ys).^2).^(-2)+2.*a.^4.*b.^(-3).*((-1).*xd+xs).^(-4) ...
  .*((-1).*yd+ys).^4.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-2)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-3/2)).*((-1/2).*((xa+ ...
  (-1).*xd).^2+(ya+(-1).*yd).^2).^(1/2).*(2.*a.^4.*b.^(-2).*((-1).*xa+xd) ...
  .^(-3).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).* ...
  ya+yd).^2).^(-2)+2.*a.^4.*b.^(-2).*((-1).*xa+xd).^(-5).*((-1).*ya+yd) ...
  .^4.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+(-2) ...
  .*a.^2.*((-1).*xa+xd).^(-3).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).* ...
  ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^( ...
  -1)).^(-3/2)+(-1).*(xa+(-1).*xd).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^( ...
  -1/2).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2) ...
  .^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*(( ...
  -1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-1/2)+(-1/2).*(((-1).*xd+ ...
  xs).^2+((-1).*yd+ys).^2).^(1/2).*((-2).*a.^4.*b.^(-2).*((-1).*xd+xs).^( ...
  -3).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ ...
  ys).^2).^(-2)+(-2).*a.^4.*b.^(-2).*((-1).*xd+xs).^(-5).*((-1).*yd+ys) ...
  .^4.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+2.* ...
  a.^2.*((-1).*xd+xs).^(-3).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).* ...
  yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^( ...
  -1)).^(-3/2)+(-1).*((-1).*xd+xs).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^( ...
  -1/2).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2) ...
  .^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*(( ...
  -1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-1/2));((-1/2).*((xa+(-1) ...
  .*xd).^2+(ya+(-1).*yd).^2).^(1/2).*(2.*a.^4.*b.^(-2).*((-1).*xa+xd).^( ...
  -3).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+ ...
  yd).^2).^(-2)+2.*a.^4.*b.^(-2).*((-1).*xa+xd).^(-5).*((-1).*ya+yd).^4.*( ...
  1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+(-2).* ...
  a.^2.*((-1).*xa+xd).^(-3).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).* ...
  ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^( ...
  -1)).^(-3/2)+(-1).*(xa+(-1).*xd).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^( ...
  -1/2).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2) ...
  .^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*(( ...
  -1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-1/2)+(-1/2).*(((-1).*xd+ ...
  xs).^2+((-1).*yd+ys).^2).^(1/2).*((-2).*a.^4.*b.^(-2).*((-1).*xd+xs).^( ...
  -3).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ ...
  ys).^2).^(-2)+(-2).*a.^4.*b.^(-2).*((-1).*xd+xs).^(-5).*((-1).*yd+ys) ...
  .^4.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+2.* ...
  a.^2.*((-1).*xd+xs).^(-3).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).* ...
  yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^( ...
  -1)).^(-3/2)+(-1).*((-1).*xd+xs).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^( ...
  -1/2).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2) ...
  .^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*(( ...
  -1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-1/2)).*((-1/2).*((xa+(-1) ...
  .*xd).^2+(ya+(-1).*yd).^2).^(1/2).*((-2).*a.^4.*b.^(-2).*((-1).*xa+xd) ...
  .^(-2).*((-1).*ya+yd).*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+ ...
  yd).^2).^(-2)+(-2).*a.^4.*b.^(-2).*((-1).*xa+xd).^(-4).*((-1).*ya+yd) ...
  .^3.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+2.* ...
  a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).*(1+a.^2.*b.^(-2).*((-1).*xa+ ...
  xd).^(-2).*((-1).*ya+yd).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+ ...
  xd).^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+ ...
  yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)) ...
  .^(-3/2)+(-1).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^(-1/2).*(ya+(-1).* ...
  yd).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^( ...
  -1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1) ...
  .*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-1/2)+(-1/2).*(((-1).*xd+xs) ...
  .^2+((-1).*yd+ys).^2).^(1/2).*(2.*a.^4.*b.^(-2).*((-1).*xd+xs).^(-2).*(( ...
  -1).*yd+ys).*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^( ...
  -2)+2.*a.^4.*b.^(-2).*((-1).*xd+xs).^(-4).*((-1).*yd+ys).^3.*(1+a.^2.* ...
  b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+(-2).*a.^2.*((-1) ...
  .*xd+xs).^(-2).*((-1).*yd+ys).*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*(( ...
  -1).*yd+ys).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*(( ...
  -1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+ ...
  a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-3/2)+( ...
  -1).*((-1).*yd+ys).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^(-1/2).*(a.^2.* ...
  (1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*(( ...
  -1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^( ...
  -2).*((-1).*yd+ys).^2).^(-1)).^(-1/2)),((-1/2).*((xa+(-1).*xd).^2+(ya+( ...
  -1).*yd).^2).^(1/2).*((-2).*a.^4.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).* ...
  ya+yd).*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+( ...
  -2).*a.^4.*b.^(-2).*((-1).*xa+xd).^(-4).*((-1).*ya+yd).^3.*(1+a.^2.*b.^( ...
  -2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+2.*a.^2.*((-1).*xa+xd) ...
  .^(-2).*((-1).*ya+yd).*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+ ...
  yd).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+ ...
  yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^( ...
  -2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-3/2)+(-1).*((xa+( ...
  -1).*xd).^2+(ya+(-1).*yd).^2).^(-1/2).*(ya+(-1).*yd).*(a.^2.*(1+a.^2.* ...
  b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+ ...
  xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*(( ...
  -1).*ya+yd).^2).^(-1)).^(-1/2)+(-1/2).*(((-1).*xd+xs).^2+((-1).*yd+ys) ...
  .^2).^(1/2).*(2.*a.^4.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).*(1+ ...
  a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+2.*a.^4.* ...
  b.^(-2).*((-1).*xd+xs).^(-4).*((-1).*yd+ys).^3.*(1+a.^2.*b.^(-2).*((-1) ...
  .*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+(-2).*a.^2.*((-1).*xd+xs).^(-2) ...
  .*((-1).*yd+ys).*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-3/2)+(-1).*((-1).*yd+ ...
  ys).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^(-1/2).*(a.^2.*(1+a.^2.*b.^( ...
  -2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^( ...
  -2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ ...
  ys).^2).^(-1)).^(-1/2)).^2,((-1/2).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2) ...
  .^(1/2).*((-2).*a.^3.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*( ...
  1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+(-2).* ...
  a.^3.*b.^(-2).*((-1).*xa+xd).^(-4).*((-1).*ya+yd).^4.*(1+a.^2.*b.^(-2).* ...
  ((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+2.*a.*(1+a.^2.*b.^(-2).*(( ...
  -1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+2.*a.*((-1).*xa+xd).^(-2).*(( ...
  -1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2) ...
  .^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2) ...
  .^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*(( ...
  -1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-3/2)+(-1/2).*(((-1).*xd+ ...
  xs).^2+((-1).*yd+ys).^2).^(1/2).*((-2).*a.^3.*b.^(-2).*((-1).*xd+xs).^( ...
  -2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ ...
  ys).^2).^(-2)+(-2).*a.^3.*b.^(-2).*((-1).*xd+xs).^(-4).*((-1).*yd+ys) ...
  .^4.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+2.* ...
  a.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+2.*a.* ...
  ((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs) ...
  .^(-2).*((-1).*yd+ys).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs) ...
  .^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^( ...
  -3/2)).*((-1/2).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^(1/2).*((-2).* ...
  a.^4.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).*(1+a.^2.*b.^(-2).*(( ...
  -1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+(-2).*a.^4.*b.^(-2).*((-1).* ...
  xa+xd).^(-4).*((-1).*ya+yd).^3.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*( ...
  (-1).*ya+yd).^2).^(-2)+2.*a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).*(1+ ...
  a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).*(a.^2.*(1+ ...
  a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1) ...
  .*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2) ...
  .*((-1).*ya+yd).^2).^(-1)).^(-3/2)+(-1).*((xa+(-1).*xd).^2+(ya+(-1).*yd) ...
  .^2).^(-1/2).*(ya+(-1).*yd).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^( ...
  -2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd) ...
  .^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^( ...
  -1/2)+(-1/2).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^(1/2).*(2.*a.^4.*b.^( ...
  -2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).*(1+a.^2.*b.^(-2).*((-1).*xd+xs) ...
  .^(-2).*((-1).*yd+ys).^2).^(-2)+2.*a.^4.*b.^(-2).*((-1).*xd+xs).^(-4).*( ...
  (-1).*yd+ys).^3.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-2)+(-2).*a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).*(1+a.^2.*b.^( ...
  -2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^( ...
  -2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^( ...
  -2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ ...
  ys).^2).^(-1)).^(-3/2)+(-1).*((-1).*yd+ys).*(((-1).*xd+xs).^2+((-1).*yd+ ...
  ys).^2).^(-1/2).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).* ...
  yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.* ...
  b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-1/2)),((-1/2) ...
  .*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^(1/2).*(2.*a.^4.*b.^(-3).*((-1).* ...
  xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*( ...
  (-1).*ya+yd).^2).^(-2)+2.*a.^4.*b.^(-3).*((-1).*xa+xd).^(-4).*((-1).*ya+ ...
  yd).^4.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)) ...
  .*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+ ...
  a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-3/2)+(-1/2).*(((-1).*xd+xs) ...
  .^2+((-1).*yd+ys).^2).^(1/2).*(2.*a.^4.*b.^(-3).*((-1).*xd+xs).^(-2).*(( ...
  -1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2) ...
  .^(-2)+2.*a.^4.*b.^(-3).*((-1).*xd+xs).^(-4).*((-1).*yd+ys).^4.*(1+ ...
  a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)).*(a.^2.*(1+ ...
  a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1) ...
  .*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2) ...
  .*((-1).*yd+ys).^2).^(-1)).^(-3/2)).*((-1/2).*((xa+(-1).*xd).^2+(ya+(-1) ...
  .*yd).^2).^(1/2).*((-2).*a.^4.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+ ...
  yd).*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+(-2) ...
  .*a.^4.*b.^(-2).*((-1).*xa+xd).^(-4).*((-1).*ya+yd).^3.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+2.*a.^2.*((-1).*xa+xd).^( ...
  -2).*((-1).*ya+yd).*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd) ...
  .^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd) ...
  .^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-3/2)+(-1).*((xa+(-1) ...
  .*xd).^2+(ya+(-1).*yd).^2).^(-1/2).*(ya+(-1).*yd).*(a.^2.*(1+a.^2.*b.^( ...
  -2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^( ...
  -2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+ ...
  yd).^2).^(-1)).^(-1/2)+(-1/2).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^( ...
  1/2).*(2.*a.^4.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).*(1+a.^2.* ...
  b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+2.*a.^4.*b.^(-2).* ...
  ((-1).*xd+xs).^(-4).*((-1).*yd+ys).^3.*(1+a.^2.*b.^(-2).*((-1).*xd+xs) ...
  .^(-2).*((-1).*yd+ys).^2).^(-2)+(-2).*a.^2.*((-1).*xd+xs).^(-2).*((-1).* ...
  yd+ys).*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)) ...
  .*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+ ...
  a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-3/2)+(-1).*((-1).*yd+ys).*((( ...
  -1).*xd+xs).^2+((-1).*yd+ys).^2).^(-1/2).*(a.^2.*(1+a.^2.*b.^(-2).*((-1) ...
  .*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1) ...
  .*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^( ...
  -1)).^(-1/2));((-1/2).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^(1/2).*((-2) ...
  .*a.^3.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+(-2).*a.^3.*b.^(-2).*(( ...
  -1).*xa+xd).^(-4).*((-1).*ya+yd).^4.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^( ...
  -2).*((-1).*ya+yd).^2).^(-2)+2.*a.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2) ...
  .*((-1).*ya+yd).^2).^(-1)+2.*a.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*( ...
  1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).*(a.^2.*( ...
  1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*(( ...
  -1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^( ...
  -2).*((-1).*ya+yd).^2).^(-1)).^(-3/2)+(-1/2).*(((-1).*xd+xs).^2+((-1).* ...
  yd+ys).^2).^(1/2).*((-2).*a.^3.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ ...
  ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+( ...
  -2).*a.^3.*b.^(-2).*((-1).*xd+xs).^(-4).*((-1).*yd+ys).^4.*(1+a.^2.*b.^( ...
  -2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+2.*a.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+2.*a.*((-1).*xd+xs).^(-2) ...
  .*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-3/2)).*((-1/2).*((xa+ ...
  (-1).*xd).^2+(ya+(-1).*yd).^2).^(1/2).*(2.*a.^4.*b.^(-2).*((-1).*xa+xd) ...
  .^(-3).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).* ...
  ya+yd).^2).^(-2)+2.*a.^4.*b.^(-2).*((-1).*xa+xd).^(-5).*((-1).*ya+yd) ...
  .^4.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+(-2) ...
  .*a.^2.*((-1).*xa+xd).^(-3).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).* ...
  ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^( ...
  -1)).^(-3/2)+(-1).*(xa+(-1).*xd).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^( ...
  -1/2).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2) ...
  .^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*(( ...
  -1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-1/2)+(-1/2).*(((-1).*xd+ ...
  xs).^2+((-1).*yd+ys).^2).^(1/2).*((-2).*a.^4.*b.^(-2).*((-1).*xd+xs).^( ...
  -3).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ ...
  ys).^2).^(-2)+(-2).*a.^4.*b.^(-2).*((-1).*xd+xs).^(-5).*((-1).*yd+ys) ...
  .^4.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+2.* ...
  a.^2.*((-1).*xd+xs).^(-3).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).* ...
  yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^( ...
  -1)).^(-3/2)+(-1).*((-1).*xd+xs).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^( ...
  -1/2).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2) ...
  .^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*(( ...
  -1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-1/2)),((-1/2).*((xa+(-1) ...
  .*xd).^2+(ya+(-1).*yd).^2).^(1/2).*((-2).*a.^3.*b.^(-2).*((-1).*xa+xd) ...
  .^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).* ...
  ya+yd).^2).^(-2)+(-2).*a.^3.*b.^(-2).*((-1).*xa+xd).^(-4).*((-1).*ya+yd) ...
  .^4.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+2.* ...
  a.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+2.*a.* ...
  ((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd) ...
  .^(-2).*((-1).*ya+yd).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd) ...
  .^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd) ...
  .^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^( ...
  -3/2)+(-1/2).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^(1/2).*((-2).*a.^3.* ...
  b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1) ...
  .*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+(-2).*a.^3.*b.^(-2).*((-1).*xd+ ...
  xs).^(-4).*((-1).*yd+ys).^4.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*(( ...
  -1).*yd+ys).^2).^(-2)+2.*a.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1) ...
  .*yd+ys).^2).^(-1)+2.*a.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+ ...
  a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).*(a.^2.*(1+ ...
  a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1) ...
  .*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2) ...
  .*((-1).*yd+ys).^2).^(-1)).^(-3/2)).*((-1/2).*((xa+(-1).*xd).^2+(ya+(-1) ...
  .*yd).^2).^(1/2).*((-2).*a.^4.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+ ...
  yd).*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+(-2) ...
  .*a.^4.*b.^(-2).*((-1).*xa+xd).^(-4).*((-1).*ya+yd).^3.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+2.*a.^2.*((-1).*xa+xd).^( ...
  -2).*((-1).*ya+yd).*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd) ...
  .^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd) ...
  .^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-3/2)+(-1).*((xa+(-1) ...
  .*xd).^2+(ya+(-1).*yd).^2).^(-1/2).*(ya+(-1).*yd).*(a.^2.*(1+a.^2.*b.^( ...
  -2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^( ...
  -2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+ ...
  yd).^2).^(-1)).^(-1/2)+(-1/2).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^( ...
  1/2).*(2.*a.^4.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).*(1+a.^2.* ...
  b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+2.*a.^4.*b.^(-2).* ...
  ((-1).*xd+xs).^(-4).*((-1).*yd+ys).^3.*(1+a.^2.*b.^(-2).*((-1).*xd+xs) ...
  .^(-2).*((-1).*yd+ys).^2).^(-2)+(-2).*a.^2.*((-1).*xd+xs).^(-2).*((-1).* ...
  yd+ys).*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)) ...
  .*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+ ...
  a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-3/2)+(-1).*((-1).*yd+ys).*((( ...
  -1).*xd+xs).^2+((-1).*yd+ys).^2).^(-1/2).*(a.^2.*(1+a.^2.*b.^(-2).*((-1) ...
  .*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1) ...
  .*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^( ...
  -1)).^(-1/2)),((-1/2).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^(1/2).*((-2) ...
  .*a.^3.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+(-2).*a.^3.*b.^(-2).*(( ...
  -1).*xa+xd).^(-4).*((-1).*ya+yd).^4.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^( ...
  -2).*((-1).*ya+yd).^2).^(-2)+2.*a.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2) ...
  .*((-1).*ya+yd).^2).^(-1)+2.*a.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*( ...
  1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).*(a.^2.*( ...
  1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*(( ...
  -1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^( ...
  -2).*((-1).*ya+yd).^2).^(-1)).^(-3/2)+(-1/2).*(((-1).*xd+xs).^2+((-1).* ...
  yd+ys).^2).^(1/2).*((-2).*a.^3.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ ...
  ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+( ...
  -2).*a.^3.*b.^(-2).*((-1).*xd+xs).^(-4).*((-1).*yd+ys).^4.*(1+a.^2.*b.^( ...
  -2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+2.*a.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+2.*a.*((-1).*xd+xs).^(-2) ...
  .*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-3/2)).^2,((-1/2).*(( ...
  xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^(1/2).*(2.*a.^4.*b.^(-3).*((-1).*xa+ ...
  xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*(( ...
  -1).*ya+yd).^2).^(-2)+2.*a.^4.*b.^(-3).*((-1).*xa+xd).^(-4).*((-1).*ya+ ...
  yd).^4.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)) ...
  .*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+ ...
  a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-3/2)+(-1/2).*(((-1).*xd+xs) ...
  .^2+((-1).*yd+ys).^2).^(1/2).*(2.*a.^4.*b.^(-3).*((-1).*xd+xs).^(-2).*(( ...
  -1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2) ...
  .^(-2)+2.*a.^4.*b.^(-3).*((-1).*xd+xs).^(-4).*((-1).*yd+ys).^4.*(1+ ...
  a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)).*(a.^2.*(1+ ...
  a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1) ...
  .*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2) ...
  .*((-1).*yd+ys).^2).^(-1)).^(-3/2)).*((-1/2).*((xa+(-1).*xd).^2+(ya+(-1) ...
  .*yd).^2).^(1/2).*((-2).*a.^3.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+ ...
  yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+( ...
  -2).*a.^3.*b.^(-2).*((-1).*xa+xd).^(-4).*((-1).*ya+yd).^4.*(1+a.^2.*b.^( ...
  -2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+2.*a.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+2.*a.*((-1).*xa+xd).^(-2) ...
  .*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd) ...
  .^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd) ...
  .^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-3/2)+(-1/2).*(((-1).* ...
  xd+xs).^2+((-1).*yd+ys).^2).^(1/2).*((-2).*a.^3.*b.^(-2).*((-1).*xd+xs) ...
  .^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).* ...
  yd+ys).^2).^(-2)+(-2).*a.^3.*b.^(-2).*((-1).*xd+xs).^(-4).*((-1).*yd+ys) ...
  .^4.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+2.* ...
  a.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+2.*a.* ...
  ((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs) ...
  .^(-2).*((-1).*yd+ys).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs) ...
  .^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^( ...
  -3/2));((-1/2).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^(1/2).*(2.*a.^4.* ...
  b.^(-3).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1) ...
  .*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+2.*a.^4.*b.^(-3).*((-1).*xa+xd) ...
  .^(-4).*((-1).*ya+yd).^4.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).* ...
  ya+yd).^2).^(-2)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).* ...
  ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.* ...
  b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-3/2)+(-1/2).*( ...
  ((-1).*xd+xs).^2+((-1).*yd+ys).^2).^(1/2).*(2.*a.^4.*b.^(-3).*((-1).*xd+ ...
  xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*(( ...
  -1).*yd+ys).^2).^(-2)+2.*a.^4.*b.^(-3).*((-1).*xd+xs).^(-4).*((-1).*yd+ ...
  ys).^4.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)) ...
  .*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+ ...
  a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-3/2)).*((-1/2).*((xa+(-1).*xd) ...
  .^2+(ya+(-1).*yd).^2).^(1/2).*(2.*a.^4.*b.^(-2).*((-1).*xa+xd).^(-3).*(( ...
  -1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2) ...
  .^(-2)+2.*a.^4.*b.^(-2).*((-1).*xa+xd).^(-5).*((-1).*ya+yd).^4.*(1+ ...
  a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+(-2).*a.^2.* ...
  ((-1).*xa+xd).^(-3).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd) ...
  .^(-2).*((-1).*ya+yd).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd) ...
  .^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd) ...
  .^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^( ...
  -3/2)+(-1).*(xa+(-1).*xd).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^(-1/2).* ...
  (a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+ ...
  a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-1/2)+(-1/2).*(((-1).*xd+xs) ...
  .^2+((-1).*yd+ys).^2).^(1/2).*((-2).*a.^4.*b.^(-2).*((-1).*xd+xs).^(-3) ...
  .*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-2)+(-2).*a.^4.*b.^(-2).*((-1).*xd+xs).^(-5).*((-1).*yd+ys).^4.*( ...
  1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+2.*a.^2.*( ...
  (-1).*xd+xs).^(-3).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^( ...
  -2).*((-1).*yd+ys).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^( ...
  -2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^( ...
  -3/2)+(-1).*((-1).*xd+xs).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^(-1/2).* ...
  (a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+ ...
  a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-1/2)),((-1/2).*((xa+(-1).*xd) ...
  .^2+(ya+(-1).*yd).^2).^(1/2).*(2.*a.^4.*b.^(-3).*((-1).*xa+xd).^(-2).*(( ...
  -1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2) ...
  .^(-2)+2.*a.^4.*b.^(-3).*((-1).*xa+xd).^(-4).*((-1).*ya+yd).^4.*(1+ ...
  a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)).*(a.^2.*(1+ ...
  a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1) ...
  .*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2) ...
  .*((-1).*ya+yd).^2).^(-1)).^(-3/2)+(-1/2).*(((-1).*xd+xs).^2+((-1).*yd+ ...
  ys).^2).^(1/2).*(2.*a.^4.*b.^(-3).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+2.* ...
  a.^4.*b.^(-3).*((-1).*xd+xs).^(-4).*((-1).*yd+ys).^4.*(1+a.^2.*b.^(-2).* ...
  ((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)).*(a.^2.*(1+a.^2.*b.^(-2).* ...
  ((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).* ...
  ((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-1)).^(-3/2)).*((-1/2).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^( ...
  1/2).*((-2).*a.^4.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).*(1+ ...
  a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+(-2).*a.^4.* ...
  b.^(-2).*((-1).*xa+xd).^(-4).*((-1).*ya+yd).^3.*(1+a.^2.*b.^(-2).*((-1) ...
  .*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+2.*a.^2.*((-1).*xa+xd).^(-2).*(( ...
  -1).*ya+yd).*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^( ...
  -1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^( ...
  -1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1) ...
  .*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-3/2)+(-1).*((xa+(-1).*xd) ...
  .^2+(ya+(-1).*yd).^2).^(-1/2).*(ya+(-1).*yd).*(a.^2.*(1+a.^2.*b.^(-2).*( ...
  (-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*( ...
  (-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd) ...
  .^2).^(-1)).^(-1/2)+(-1/2).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^(1/2).* ...
  (2.*a.^4.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).*(1+a.^2.*b.^(-2) ...
  .*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)+2.*a.^4.*b.^(-2).*((-1).* ...
  xd+xs).^(-4).*((-1).*yd+ys).^3.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*( ...
  (-1).*yd+ys).^2).^(-2)+(-2).*a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).*( ...
  1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).*(a.^2.*( ...
  1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*(( ...
  -1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^( ...
  -2).*((-1).*yd+ys).^2).^(-1)).^(-3/2)+(-1).*((-1).*yd+ys).*(((-1).*xd+ ...
  xs).^2+((-1).*yd+ys).^2).^(-1/2).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs) ...
  .^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^( ...
  -1/2)),((-1/2).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^(1/2).*(2.*a.^4.* ...
  b.^(-3).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1) ...
  .*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+2.*a.^4.*b.^(-3).*((-1).*xa+xd) ...
  .^(-4).*((-1).*ya+yd).^4.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).* ...
  ya+yd).^2).^(-2)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).* ...
  ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.* ...
  b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-3/2)+(-1/2).*( ...
  ((-1).*xd+xs).^2+((-1).*yd+ys).^2).^(1/2).*(2.*a.^4.*b.^(-3).*((-1).*xd+ ...
  xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*(( ...
  -1).*yd+ys).^2).^(-2)+2.*a.^4.*b.^(-3).*((-1).*xd+xs).^(-4).*((-1).*yd+ ...
  ys).^4.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-2)) ...
  .*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+ ...
  a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).* ...
  xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-3/2)).*((-1/2).*((xa+(-1).*xd) ...
  .^2+(ya+(-1).*yd).^2).^(1/2).*((-2).*a.^3.*b.^(-2).*((-1).*xa+xd).^(-2) ...
  .*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd) ...
  .^2).^(-2)+(-2).*a.^3.*b.^(-2).*((-1).*xa+xd).^(-4).*((-1).*ya+yd).^4.*( ...
  1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+2.*a.*(1+ ...
  a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)+2.*a.*((-1) ...
  .*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2) ...
  .*((-1).*ya+yd).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2) ...
  .*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*( ...
  1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^(-3/2)+( ...
  -1/2).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^(1/2).*((-2).*a.^3.*b.^(-2) ...
  .*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs) ...
  .^(-2).*((-1).*yd+ys).^2).^(-2)+(-2).*a.^3.*b.^(-2).*((-1).*xd+xs).^(-4) ...
  .*((-1).*yd+ys).^4.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-2)+2.*a.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-1)+2.*a.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).*(a.^2.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2) ...
  .*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-1)).^(-3/2)),((-1/2).*((xa+(-1).*xd).^2+(ya+(-1).*yd).^2).^(1/2) ...
  .*(2.*a.^4.*b.^(-3).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2.*(1+a.^2.* ...
  b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-2)+2.*a.^4.*b.^(-3).* ...
  ((-1).*xa+xd).^(-4).*((-1).*ya+yd).^4.*(1+a.^2.*b.^(-2).*((-1).*xa+xd) ...
  .^(-2).*((-1).*ya+yd).^2).^(-2)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd) ...
  .^(-2).*((-1).*ya+yd).^2).^(-1)+a.^2.*((-1).*xa+xd).^(-2).*((-1).*ya+yd) ...
  .^2.*(1+a.^2.*b.^(-2).*((-1).*xa+xd).^(-2).*((-1).*ya+yd).^2).^(-1)).^( ...
  -3/2)+(-1/2).*(((-1).*xd+xs).^2+((-1).*yd+ys).^2).^(1/2).*(2.*a.^4.*b.^( ...
  -3).*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2).*((-1).*xd+ ...
  xs).^(-2).*((-1).*yd+ys).^2).^(-2)+2.*a.^4.*b.^(-3).*((-1).*xd+xs).^(-4) ...
  .*((-1).*yd+ys).^4.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-2)).*(a.^2.*(1+a.^2.*b.^(-2).*((-1).*xd+xs).^(-2).*((-1).*yd+ys) ...
  .^2).^(-1)+a.^2.*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2.*(1+a.^2.*b.^(-2) ...
  .*((-1).*xd+xs).^(-2).*((-1).*yd+ys).^2).^(-1)).^(-3/2)).^2];
end